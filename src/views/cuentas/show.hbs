<html>


<head>
<meta charset="UTF-8">
<title>index</title>
	<link rel="stylesheet" href="/css/styles.css">
</head>


<body>

    <div class="btnPDF">
            <input 
                class="btn btn-secondary"
                type="submit" 
                id="btn-generar" 
                value="Generar PDF"
                onclick="generarPDF(event)">
    </div>

 <div class="divUsuarios" >
    
        

        <table id="tablecta" class="table">

            <thead>

      
                </tr>

                <tr>
                    
                     <th>Datos de la Cuenta</th>
                        

                </tr>
            </thead>

            <tbody>

                
                     <th>Id de cuenta</th>

                    <td>{{cuenta.id}}</td>

                </tr>

                <tr>

                     <th>Nombre de cuenta</th>

                    <td>{{cuenta.nombre}}</td>

                </tr>


                        <tr>

                            <th>Status</th>

                            <td>{{cuenta.status_nombre}}</td>

                        </tr>


                      <tr>

                            <th>País</th>

                            <td>{{cuenta.pais_nombre}}</td>

                        </tr>

                         <tr>

                            <th>Timezone</th>

                            <td>{{cuenta.tz}}</td>

                        </tr>
                   

                

                    </td>
                </tr>

                
            </tbody>
        </table>

    
  
    
{{!-- {{tabla plan contratado}} --}}


<div >

         <table id="planCdo" class="table">

            <thead>

      
                </tr>

                <tr>
                    
                     <th>Plan contratado</th>
                        

                </tr>
            </thead>

            <tbody>

                

                <tr>

                     <th>Vehículos</th>

                    <td>{{nVehiculos.total}}</td>

                </tr>


                        <tr>

                            <th>Usuarios de la cuenta</th>

                            <td>{{usuariosTotal.total}}</td>

                        </tr>


                      <tr>

                            <th>Conductores</th>

                            <td>{{conductoresTotal.total}}</td>

                        </tr>

                         <tr>

                            <th>Plan</th>

                            <td>{{cuenta.descripcion}}</td>

                        </tr>
                   

              
                </tr>

                
            </tbody>
        </table>

    </div>
  

    <br>

    <br>
    
    </div>

    <div class="row">
        

   
 </div >

 {{#if usuarios}}
  
{{!-- {{Tabla de usuarios}} --}}

<div  class="divUsuarios">
        <table class="table">

            <thead>

      
                
                    <th>Usuarios de la cuenta</th>
                <tr>
                    
                        <th>Role</th>
                        <th>Usuario</th>
                        <th>Email</th>
                        <th>Timezone</th>
                        
                       
                        
                    

                </tr>
            </thead>
            

            <tbody> 
                 
                 {{#each usuarios}}
                
                <tr>
                    

                    <td>{{rl}}</td>

                    <td>{{nombre}}</td>


                    <td>{{email}}</td>

                    <td>{{tz}}</td>

                   

                    

                    
                </tr>

                {{/each}}
            </tbody>

        </table>

   
 </div>


  
        {{else}}


<div  class="CeroUser">

 

        <p>**No hay usuarios asociados a esta cuenta**</p>

</div>
        
                
               

                
            
        {{/if}}



{{!-- {{Tabla de vehiculos}} --}}

<div  style="  margin-top: 40px;" class="divUsuarios">

        <table class="table">

            <thead>

      
                
                    <th>Vehículos asociados a esta cuenta</th>
                <tr>
                    
                     <th>Vehículo</th>
                        <th>Marca</th>
                        <th>Modelo</th>
                        <th>Año</th>
                        <th>Color</th>
                        <th>Status</th>
                        
                    

                </tr>
            </thead>


  <tbody> 
                 
                 {{#each vehiculos}}
                
                <tr>
                    

                    <td>{{nombreV}}</td>

                    <td>{{brand}}</td>


                    <td>{{modelo}}</td>

                    <td>{{year}}</td>

                    <td>{{color}}</td>

                    <td>{{vhls}}</td>

                    

                </tr>

                {{/each}}
            </tbody>




    </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.debug.js"></script>
     


    <script type="text/javascript">

//crear PDF
function generarPDF(event) {
    event.preventDefault()

    const tbody = document.querySelector('tbody')
    if(tbody.childElementCount === 0) {
        alert('No se puede crear el PDF ya que no existen registros en la tabla')
        return
    }
    
    const str = recorrerTabla()

    
    const doc = new jsPDF()
    doc.text(10, 10, str)
    
}

function recorrerTabla() {
    let str = ''

    const table = document.getElementById('tablecta')

    for (let i = 0; i <= table.rows.length-1; i++) {
        str += '\n'
        for (let j = 0; j <= table.rows[i].cells.length-1; j++) {

            
            if(j == 0) {

                window.print ('Detalle de cuenta')
                
               
                
            } else {
                let col = table.rows[i].cells[j].innerText
                str += `${col}`
            }    
        }
        break;
    }
    
    return str    
}
</Script>



   </body> 

    </html>
