<html>
<head>
<meta charset="UTF-8">
<title>index</title>
	<link rel="stylesheet" href="/css/styles.css">
</head>


<div class="add">


    <div  class="formulario">
            
           
      
        <form class="user"  method="POST" id="FormUsuario">

                 <br>
                <label style="font-size: 20px; color: rgb(27, 73, 240);" >Editar usuario</label>
                 <br>
                 <br>
                
                <div class="row" >
                  
                    <br>
                     <label >Nombre de usuario:<Span class = "rojo"> * </span></label>
                      
                     <br>
                    <input type="text" style="width:450px" class=" border rounded" name="nombre" id="userName" value="{{usuario.nombre}}" placeholder="nombre" autofocus>
                    <div id="nombreMessage" class="message"></div>

                </div>
                <br>

                <div class="row" >

                    <label >email:<Span class = "rojo"> * </span></label>

                <br>
                    <input type="email" style="width:450px" class=" border rounded" name="email" id="email_id" value="{{usuario.email}}" placeholder="email" autofocus>

                    <div id="emailMessage" class="message"></div>
                </div>

                 <br>
                
                <div class="row" >
                <div class="col">
            
                    <label >Role:<Span class = "rojo"> * </span></label>

                     <select class=" form-select form-select-sm " style="width:auto"  name="rol_id" id="rol_id">

                            <option value="">-- Roles--</option>

                            {{#each roles}} 

                                
                                <option value="{{id_rol}}" {{#if selected}}selected{{/if}}>{{rol}}</option>
                          
                            {{/each}}

                     </select>

                          <div id="rolMessage" class="message"></div>
                </div>
                <br>
       
            
                <div class="col">
                    <label >Zona horaria:<Span class = "rojo"> * </span></label>
                    
                       <select class=" form-select form-select-sm " style="width:auto" name="timezone" id="timezone_id">

                            <option value="">-- Zona horaria--</option>

                            {{#each timezones}} 

                                
                                <option value="{{id_timezone}}" {{#if selected}}selected{{/if}}>{{timezone}}</option>
                          
                            {{/each}}

                     </select>
                          <div id="timezoneMessage" class="message"></div>
                      

                </div>
                 </div>
    
                </form>

                     <br>
                

                <br>
                    <div class="form-g">

                    <button  class="btn btn-primary" id="btnSave">

                        Guardar
                    </button>



                  <button class="btn btn-primary" id="btnCancel">Cancelar</button>

               



                    <br>
                    <br>
                </div>
                
                 <Span class = "rojo">* </span>
                    <label class="text-secondary" >No debes dejar campos debe quedar vacíos</label>

                    <br>
                    <br>



              </div>
                
              
            <div class="EditUser">

                                <img src="/img/EditUser.png" class="img-fluid">

            </div>
                    



        


    </div>

        <script src="bootstrap-5.2.0-dist/js/jquery-3.6.1.min.js"></script>
		<script src="popper/popper.min.js"></script>
		<script src="bootstrap-5.2.0-dist/js/bootstrap.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
       
           {{!-- Botón aceptar --}}
        <script>
           


            $( document ).ready(function() {

                $( "#btnSave" ).click(function(e) {

                    e.preventDefault();

                    const account= {

                        nombre: $("#userName").val(),
                        rol_id:  $("#rol_id").val(),
                        email:  $("#email_id").val(), 
                        timezone_id:  $("#timezone_id").val(),
                        
                    }

                    console.log(account)
                    $.post( "/user/{{usuario.usuario_id}}/edit", account, function( data ) {

                        if(data.status=="ok"){

                            window.location.href = '/user/showUser/';

                        }else{
                            
                            $("#nombreMessage").text(data.errors.nombre || "")
                            $("#rolMessage").html(data.errors.rol_id || "")
                            $("#emailMessage").html(data.errors.email|| "")
                            $("#timezoneMessage").html(data.errors.timezone_id|| "")
                            
                            
                        }
                    });
                
                });

            });


        </script>	

        {{!-- Botón cancelar --}}
            </script>	

{{!-- botón cancelar --}}
         <script>
           
            $( document ).ready(function() {

                $( "#btnCancel" ).click(function(e) {

                    e.preventDefault();
                     
        
                   window.location.href = '/profile';
                
                });

            });

             

        </script>	
</div>
</html>




